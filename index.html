<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>êµ­í¬ì¬ìˆ˜í•™ì „ë¬¸í•™ì› - Professional Faculty</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+KR:wght@400;600;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <style>
        :root { --color-navy-deep: #0a1128; --color-navy: #14213d; --color-gold: #c5a065; --color-gold-light: #e6d2b5; --color-red: #9e1b27; --color-bg-main: #f3f4f6; --color-white: #ffffff; --color-text-dark: #1a1a1a; --font-serif: 'Noto Serif KR', serif; --font-sans: 'Pretendard', sans-serif; --shadow-card: 0 15px 35px -5px rgba(0, 0, 0, 0.1); }
        * { box-sizing: border-box; margin: 0; padding: 0; outline: none; }
        body { font-family: var(--font-sans); background-color: var(--color-bg-main); color: var(--color-text-dark); line-height: 1.75; word-break: keep-all; background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E"); }
        .hidden { display: none !important; }
        .container { max-width: 900px; margin: 0 auto; min-height: 100vh; background: #fff; box-shadow: 0 0 50px rgba(0,0,0,0.1); position: relative; }
        
        #main-view { padding-bottom: 5rem; }
        .main-header { background: linear-gradient(160deg, var(--color-navy-deep) 0%, var(--color-navy) 100%); color: white; padding: 4rem 2rem; text-align: center; border-bottom: 4px solid var(--color-gold); }
        .main-logo-text { font-family: var(--font-serif); font-size: 2.2rem; font-weight: 900; background: linear-gradient(90deg, var(--color-gold-light), var(--color-gold)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; margin-bottom: 1rem; letter-spacing: -1px; }
        .main-slogan { font-size: 1.1rem; opacity: 0.8; font-weight: 300; letter-spacing: 0.2em; }
        .faculty-title { margin-top: 25px; font-size: 1rem; color: var(--color-gold); text-transform: uppercase; letter-spacing: 3px; font-weight: 600; position: relative; display: inline-block; }
        .faculty-title::after { content: ''; display: block; width: 40px; height: 1px; background: var(--color-gold); margin: 8px auto 0; opacity: 0.5; }
        
        .teacher-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 1.5rem; padding: 3rem 2rem; max-width: 900px; margin: 0 auto; }
        .teacher-card-btn { background: white; border: 1px solid rgba(0,0,0,0.05); border-radius: 8px; padding: 2.5rem 1rem; cursor: pointer; box-shadow: var(--shadow-card); transition: all 0.3s ease; text-align: center; position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; min-height: 180px; }
        .teacher-card-btn.empty-slot { box-shadow: none; border: 1px dashed rgba(0,0,0,0.1); background: rgba(0,0,0,0.01); cursor: default; }
        .teacher-card-btn:not(.empty-slot):hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.15); }
        .t-subject { font-size: 0.8rem; color: var(--color-gold); font-weight: 700; text-transform: uppercase; display: block; margin-bottom: 0.8rem; }
        .t-name { font-family: var(--font-serif); font-size: 1.6rem; font-weight: 900; color: var(--color-navy-deep); word-break: keep-all; }

        .nav-bar { position: absolute; top: 20px; left: 20px; z-index: 100; }
        .back-btn { background: rgba(255,255,255,0.1); border: 1px solid rgba(255,255,255,0.3); color: white; padding: 8px 16px; border-radius: 30px; cursor: pointer; font-size: 0.9rem; backdrop-filter: blur(5px); }
        .back-btn:hover { background: white; color: var(--color-navy); }
        .detail-header { background: linear-gradient(160deg, var(--color-navy-deep) 0%, var(--color-navy) 100%); color: white; padding: 5rem 2rem 3rem; text-align: center; position: relative; }
        .d-teacher-badge { color: var(--color-gold); font-family: var(--font-serif); letter-spacing: 2px; font-weight: 600; font-size: 0.9rem; margin-bottom: 10px; display: block; }
        .d-teacher-name { font-family: var(--font-serif); font-size: 3rem; font-weight: 900; margin-bottom: 0.5rem; }
        .d-subtitle { opacity: 0.8; font-weight: 300; }
        .section { padding: 4rem 2rem; border-bottom: 1px solid #eee; }
        .section-title { font-family: var(--font-serif); font-size: 1.6rem; font-weight: 900; color: var(--color-navy-deep); text-align: center; margin-bottom: 2.5rem; display: block; }
        .greeting-box { background: white; padding: 2.5rem; text-align: center; border: 1px solid #eee; box-shadow: var(--shadow-card); position: relative; border-radius: 4px; }
        .greeting-text { white-space: pre-line; color: #333; font-weight: 500; font-family: var(--font-serif); }
        .card-grid { display: grid; gap: 1.5rem; }
        .info-card { background: white; padding: 2rem; border-radius: 8px; box-shadow: var(--shadow-card); position: relative; border: 1px solid rgba(0,0,0,0.05); }
        .test-card { border-top: 4px solid var(--color-navy); }
        .assign-card { border-top: 4px solid var(--color-red); }
        .video-card { border-top: 4px solid var(--color-gold); }
        .card-badge { background: var(--color-navy-deep); color: var(--color-gold); padding: 4px 10px; font-size: 0.8rem; font-weight: bold; border-radius: 2px; margin-bottom: 10px; display: inline-block; }
        .card-title { font-family: var(--font-serif); font-weight: 900; font-size: 1.3rem; margin-bottom: 5px; color: var(--color-navy); }
        .card-desc { white-space: pre-line; color: #666; font-size: 0.95rem; margin-top: 10px; }
        .rules-bg { background: linear-gradient(145deg, var(--color-navy-deep), #1a2644); padding: 2.5rem; border-radius: 8px; color: white; border: 1px solid rgba(197,160,101,0.2); }
        .rules-list li { list-style: none; position: relative; padding-left: 20px; margin-bottom: 15px; font-weight: 600; }
        .rules-list li::before { content: 'â– '; color: var(--color-red); position: absolute; left: 0; font-size: 0.8rem; top: 5px; }
        footer { background: var(--color-navy-deep); color: #888; padding: 3rem; text-align: center; font-size: 0.9rem; }
        
        #admin-controls { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; align-items: flex-end; z-index: 999; }
        .btn { padding: 10px 20px; border-radius: 50px; border: none; cursor: pointer; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2); }
        .btn-primary { background: var(--color-navy); color: white; }
        .btn-admin { background: #111; color: var(--color-gold); border: 1px solid var(--color-gold); }
        .editable-field { transition: 0.2s; }
        body.admin-mode .editable-field:hover { outline: 2px dashed var(--color-gold); background: rgba(197,160,101,0.1); cursor: text; color: black !important; }
        body.admin-mode .delete-btn { display: block; }
        .delete-btn { display: none; position: absolute; top: 15px; right: 15px; background: none; border: none; color: #999; cursor: pointer; font-weight: bold; }
        
        #loading-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #fff; z-index: 99999; display: flex; justify-content: center; align-items: center; flex-direction: column; }
        .loader { border: 5px solid #f3f3f3; border-top: 5px solid var(--color-gold); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; margin-bottom: 20px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        @media (max-width: 768px) { .teacher-grid { grid-template-columns: 1fr; } .main-header { padding: 3rem 1.5rem; } }
    </style>
</head>
<body>
    <div id="loading-screen">
        <div class="loader"></div>
        <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì…ë‹ˆë‹¤...</p>
    </div>

    <div class="container">
        <div id="main-view">
            <header class="main-header">
                <div class="main-logo-text">êµ­í¬ì¬ìˆ˜í•™ì „ë¬¸í•™ì›</div>
                <p class="main-slogan">ìƒìœ„ê¶Œìœ¼ë¡œ ê°€ëŠ” ì§€ë¦„ê¸¸</p>
                <div class="faculty-title">Professional Faculty</div>
            </header>
            <div class="teacher-grid" id="teacher-list-container"></div>
            <footer style="margin-top:auto;"><p>Copyright Â© KUKHEEJAE. All rights reserved.</p></footer>
        </div>
        <div id="detail-view" class="hidden">
            <nav class="nav-bar"><button class="back-btn" onclick="goHome()">â† ì „ì²´ ê°•ì‚¬ì§„ ë³´ê¸°</button></nav>
            <div id="dynamic-content"></div>
            <footer>
                <p class="footer-quote editable-field" id="footer-quote">"ì••ë„ì ì¸ ì‹¤ë ¥ ì°¨ì´ëŠ” ì‹¬í™”ì—ì„œ ê²°ì •ë©ë‹ˆë‹¤"</p>
                <p>êµ­í¬ì¬ìˆ˜í•™ì „ë¬¸í•™ì› | <span id="footer-name"></span></p>
            </footer>
        </div>
    </div>

    <div id="admin-controls">
        <div id="admin-panel" class="hidden">
            <button class="btn btn-primary" onclick="saveCurrentTeacher()">ğŸ’¾ ì €ì¥ (ì¦‰ì‹œ ê³µìœ )</button>
            <button class="btn" onclick="resetCurrentTeacher()">â†» ì´ˆê¸°í™”</button>
            <button class="btn btn-admin" onclick="toggleAdmin()">ë‹«ê¸°</button>
        </div>
        <button id="admin-btn" class="btn btn-admin hidden" onclick="reqAdmin()">âš™ï¸ ê´€ë¦¬ì</button>
    </div>

    <script>
        // [â˜…ì™„ë£Œâ˜…] ì„ ìƒë‹˜ì˜ ì‹¤ì œ í‚¤ ê°’ì„ ì…ë ¥í•´ë‘ì—ˆìŠµë‹ˆë‹¤! ê±´ë“œë¦¬ì§€ ë§ˆì„¸ìš”.
        const firebaseConfig = {
            apiKey: "AIzaSyC7xlCN_PEZRKXGE7akJk7Xdz9UG7GFRxM",
            authDomain: "kukheejae-web-2dc27.firebaseapp.com",
            databaseURL: "https://kukheejae-web-2dc27-default-rtdb.firebaseio.com",
            projectId: "kukheejae-web-2dc27",
            storageBucket: "kukheejae-web-2dc27.firebasestorage.app",
            messagingSenderId: "1042908871730",
            appId: "1:1042908871730:web:b73e0400e5d4109b5f102b",
            measurementId: "G-BJX63FRJ7S"
        };

        firebase.initializeApp(firebaseConfig);
        const database = firebase.database();

        const DEFAULT_RULES = ["ì‚¬ì „ ì—°ë½ í•„ìˆ˜ (í•™ë¶€ëª¨ í™•ì¸)", "ê²°ì„ ì‹œ ì˜ìƒë³´ê°• + ì¸ì¦ í…ŒìŠ¤íŠ¸", "ê³¼ì œ ë¯¸í¡ ì‹œ ê·€ê°€ ì œí•œ"];
        const DEFAULT_ASSIGN = ["AI ì˜¤ë‹µë…¸íŠ¸ ì œê³µ", "ë§¤ ìˆ˜ì—… ê²°ê³¼ ë¬¸ì ì „ì†¡", "ì¼ì¼ í…ŒìŠ¤íŠ¸ ë¯¸í†µê³¼ì í´ë¦¬ë‹‰"];
        
        function createTeacher(id, name, subject, isDisabled = false) {
            return {
                id: id, name: name, subject: subject, isDisabled: isDisabled,
                subtitle: "2026 Winter Master Class",
                greeting: `ì•ˆë…•í•˜ì‹­ë‹ˆê¹Œ. êµ­í¬ì¬ ${name}ì…ë‹ˆë‹¤.\n\nìˆ˜í•™ 1ë“±ê¸‰ì„ ê°€ë¥´ëŠ” ê²°ì •ì  ì°¨ì´ëŠ”\n'ì–¼ë§ˆë‚˜ ê¹Šì´ ìˆê²Œ íŒŒê³ ë“¤ì—ˆëŠ”ê°€'ì—ì„œ íŒê°€ë¦„ ë‚©ë‹ˆë‹¤.\n\ní•™ìƒì´ í˜ë¦° ë•€ë°©ìš¸ì´ í—›ë˜ì§€ ì•Šë„ë¡\nì••ë„ì ì¸ ê°•ì˜ë ¥ê³¼ ë¹ˆí‹ˆì—†ëŠ” ê´€ë¦¬ë¡œ\në°˜ë“œì‹œ ìµœìƒì˜ ê²°ê³¼ë¥¼ ì¦ëª…í•´ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.`,
                tests: [{ grade: "ëŒ€ìƒ í•™ë…„", subject: "ìˆ˜ì—…ëª… ì˜ˆì‹œ", time: "ìš”ì¼/ì‹œê°„", desc: "ìˆ˜ì—… ìƒì„¸ ì„¤ëª…ì„ ì…ë ¥í•˜ì„¸ìš”." }],
                assignments: { title: "Management", items: [...DEFAULT_ASSIGN] },
                videos: { title: "Review System", items: ["ê³ í™”ì§ˆ ë³µìŠµ ì˜ìƒ ì œê³µ", "24ì‹œê°„ Q&A ì±„ë„ ìš´ì˜"] },
                rules: { title: "í•™ìŠµ ê·œì •", items: [...DEFAULT_RULES] }
            };
        }

        const INITIAL_DB = [
            createTeacher(0, "êµ­í¬ì¬T", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(1, "ì •ì¬ë´‰T", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(2, "ê°•í•œìˆ˜T", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(3, "ì–‘ê·€ì œT", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(4, "ìµœëˆ„ë¦¬T", "ëŒ€í‘œê°•ì‚¬ / ì¤‘,ê³ ë“±ë¶€"),
            createTeacher(5, "ì´ì°½ë™T", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(6, "ì˜¤ìŠ¹ì£¼T", "ëŒ€í‘œê°•ì‚¬ / ì¤‘,ê³ ë“±ë¶€"),
            createTeacher(7, "ê¹€ë„ì—°T", "ëŒ€í‘œê°•ì‚¬ / ì´ˆ,ì¤‘ë“±ë¶€"),
            createTeacher(8, "ê¹€ì¶©í˜„T", "ëŒ€í‘œê°•ì‚¬ / ê³ ë“±ë¶€"),
            createTeacher(9, "ë°±ìœ¤ì„±T", "ëŒ€í‘œê°•ì‚¬ / ìˆ˜ë¦¬ë…¼ìˆ ")
        ];

        let db = [];
        let currentIdx = null;
        let isAdmin = false;

        function init() {
            // Firebaseì—ì„œ ì‹¤ì‹œê°„ ë°ì´í„° ë¦¬ìŠ¤ë‹
            database.ref('teachers').on('value', (snapshot) => {
                const data = snapshot.val();
                if (data) {
                    db = data;
                } else {
                    db = JSON.parse(JSON.stringify(INITIAL_DB));
                    // ìµœì´ˆ 1íšŒ ë¹ˆ ë°ì´í„°ë¼ë©´ ì´ˆê¸°ê°’ ì „ì†¡
                    database.ref('teachers').set(db); 
                }
                renderLobby();
                if(currentIdx !== null) renderDetail(db[currentIdx]);
                document.getElementById('loading-screen').style.display = 'none';
            }, (error) => {
                alert("ë°ì´í„° ë¡œë”© ì‹¤íŒ¨! íŒŒì´ì–´ë² ì´ìŠ¤ 'ê·œì¹™(Rules)' ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.");
                document.getElementById('loading-screen').style.display = 'none';
            });
        }

        function renderLobby() {
            const container = document.getElementById('teacher-list-container');
            container.innerHTML = db.map((t, i) => {
                if (t.isDisabled) return `<div class="teacher-card-btn empty-slot"></div>`;
                return `<div class="teacher-card-btn" onclick="openTeacher(${i})"><span class="t-subject">${t.subject}</span><h3 class="t-name">${t.name}</h3></div>`;
            }).join('');
        }

        function openTeacher(idx) {
            if(db[idx].isDisabled) return;
            currentIdx = idx;
            document.getElementById('main-view').classList.add('hidden');
            document.getElementById('detail-view').classList.remove('hidden');
            document.getElementById('admin-btn').classList.remove('hidden');
            renderDetail(db[idx]);
            window.scrollTo(0, 0);
        }

        function goHome() {
            currentIdx = null; isAdmin = false;
            document.body.classList.remove('admin-mode');
            document.getElementById('admin-panel').classList.add('hidden');
            document.getElementById('admin-btn').classList.add('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('main-view').classList.remove('hidden');
            renderLobby();
        }

        function renderDetail(t) {
            if(!t) return;
            const content = document.getElementById('dynamic-content');
            const listHtml = (items, type) => items.map((item, i) => `<li class="editable-field" onblur="updateList('${type}', ${i}, this.innerText)" contenteditable="${isAdmin}">${item}</li>`).join('');
            const testsHtml = t.tests ? t.tests.map((test, i) => `
                <div class="info-card test-card">
                    <button class="delete-btn" onclick="delTest(${i})">âœ•</button>
                    <span class="card-badge">${test.grade}</span>
                    <h3 class="card-title editable-field" onblur="updateTest(${i}, 'subject', this.innerText)" contenteditable="${isAdmin}">${test.subject}</h3>
                    <div style="color:#c9242b; font-weight:bold; margin-bottom:10px;" class="editable-field" onblur="updateTest(${i}, 'time', this.innerText)" contenteditable="${isAdmin}">${test.time}</div>
                    <p class="card-desc editable-field" onblur="updateTest(${i}, 'desc', this.innerText)" contenteditable="${isAdmin}">${test.desc}</p>
                </div>`).join('') : '';

            content.innerHTML = `
                <header class="detail-header">
                    <span class="d-teacher-badge editable-field" onblur="updateMeta('subject', this.innerText)" contenteditable="${isAdmin}">${t.subject}</span>
                    <h1 class="d-teacher-name editable-field" onblur="updateMeta('name', this.innerText)" contenteditable="${isAdmin}">${t.name}</h1>
                    <p class="d-subtitle editable-field" onblur="updateMeta('subtitle', this.innerText)" contenteditable="${isAdmin}">${t.subtitle}</p>
                </header>
                <div class="section"><h2 class="section-title">Greeting</h2><div class="greeting-box"><div class="greeting-text editable-field" onblur="updateMeta('greeting', this.innerText)" contenteditable="${isAdmin}">${t.greeting}</div></div></div>
                <div class="section" style="background:#fcfcfc"><h2 class="section-title">Curriculum</h2><div class="admin-toolbar" style="text-align:right; margin-bottom:10px; display:${isAdmin?'block':'none'}"><button class="btn btn-primary" onclick="addTest()">+ ê°•ì˜ ì¶”ê°€</button></div><div class="card-grid">${testsHtml}</div></div>
                <div class="section"><h2 class="section-title">System</h2><div class="card-grid"><div class="info-card assign-card"><h3 class="card-title editable-field" onblur="updateNest('assignments','title',this.innerText)" contenteditable="${isAdmin}">${t.assignments.title}</h3><ul>${listHtml(t.assignments.items, 'assignments')}</ul></div><div class="info-card video-card"><h3 class="card-title editable-field" onblur="updateNest('videos','title',this.innerText)" contenteditable="${isAdmin}">${t.videos.title}</h3><ul>${listHtml(t.videos.items, 'videos')}</ul></div></div></div>
                <div class="section"><div class="rules-bg"><h3 class="section-title" style="color:#e6d2b5; margin-bottom:1.5rem;" class="editable-field" onblur="updateNest('rules','title',this.innerText)" contenteditable="${isAdmin}">${t.rules.title}</h3><ul class="rules-list">${listHtml(t.rules.items, 'rules')}</ul></div></div>`;
            document.getElementById('footer-name').innerText = t.name;
        }

        function updateMeta(k, v) { db[currentIdx][k] = v; }
        function updateNest(p, k, v) { db[currentIdx][p][k] = v; }
        function updateList(t, i, v) { db[currentIdx][t].items[i] = v; }
        function updateTest(i, k, v) { db[currentIdx].tests[i][k] = v; }
        function addTest() { db[currentIdx].tests.push({grade:"ëŒ€ìƒ", subject:"ê°•ì¢Œëª…", time:"ì‹œê°„", desc:"ì„¤ëª…"}); renderDetail(db[currentIdx]); }
        function delTest(i) { if(confirm('ì‚­ì œí•©ë‹ˆê¹Œ?')) { db[currentIdx].tests.splice(i,1); renderDetail(db[currentIdx]); } }

        function reqAdmin() {
            const pw = prompt("ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.");
            if(pw === '1234') { isAdmin = true; document.body.classList.add('admin-mode'); document.getElementById('admin-panel').classList.remove('hidden'); document.getElementById('admin-btn').classList.add('hidden'); renderDetail(db[currentIdx]); } else { alert('ë¹„ë°€ë²ˆí˜¸ ì˜¤ë¥˜'); }
        }
        function toggleAdmin() { isAdmin = false; document.body.classList.remove('admin-mode'); document.getElementById('admin-panel').classList.add('hidden'); document.getElementById('admin-btn').classList.remove('hidden'); renderDetail(db[currentIdx]); }
        
        function saveCurrentTeacher() {
            database.ref('teachers/' + currentIdx).set(db[currentIdx])
                .then(() => { alert(`âœ… [${db[currentIdx].name}] ë‚´ìš©ì´ ì„œë²„ì— ê³µìœ ë˜ì—ˆìŠµë‹ˆë‹¤.\në‹¤ë¥¸ ê¸°ê¸°ì—ì„œë„ ì¦‰ì‹œ í™•ì¸ ê°€ëŠ¥í•©ë‹ˆë‹¤.`); })
                .catch((error) => { alert('ì €ì¥ ì‹¤íŒ¨! (ê·œì¹™ ì„¤ì • í™•ì¸ í•„ìš”): ' + error.message); });
        }

        function resetCurrentTeacher() {
            if(confirm('ì´ˆê¸°í™” í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                db[currentIdx] = JSON.parse(JSON.stringify(INITIAL_DB[currentIdx]));
                renderDetail(db[currentIdx]);
            }
        }

        init();
    </script>
</body>
</html>
